name: Unzip and Commit
on:
  push:
    paths:
      - '*.zip' # هيشتغل أول ما ترفع أي ملف مضغوط

jobs:
  unzip_job:
    runs-on: ubuntu-latest
    permissions:
      contents: write # عشان يقدر يحفظ الملفات الجديدة
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4 # التحديث للإصدار v4 لتجنب الخطأ

      - name: Extract ZIP
        run: |
          unzip -o "*.zip" -d extracted_files/
          # نقل الملفات للمجلد الرئيسي
          cp -r extracted_files/* .
          rm -rf extracted_files/

      - name: Commit Changes
        run: |
          git config --global user.name "Mida-Bot"
          git config --global user.email "bot@mida.com"
          git add .
          git commit -m "Auto-unzip files from ZIP" || echo "No changes to commit"
          git push
